<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Poladent â€“ Sistema Completo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="css/styles.css" />

  <!-- Firebase SDK (compat) -->
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <!-- LibrerÃ­as -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Tu configuraciÃ³n y app (orden IMPORTA) -->
  <script defer src="firebase/config.js"></script>
  <script defer src="apps/app.js"></script>
</head>

<body>

  <!-- HEADER -->
  <div class="appHeader">
    <h1>â˜…å½¡[ðŸ¦· POLADENT ðŸ¦·]å½¡â˜…</h1>
    <p>Sistema de control de asistencia y horas laborales</p>
  </div>

  <!-- HOME -->
  <div id="home" class="homeCard">
    <div class="homeBtns">
      <button id="btnAdmin">Administrador</button>
      <button id="btnEmployee">Empleado</button>
    </div>
  </div>

  <!-- ADMIN LOGIN -->
  <div id="adminLogin" class="card hidden">
    <h3>Administrador</h3>
    <input id="adminEmail" placeholder="Correo" />
    <input id="adminPass" type="password" placeholder="ContraseÃ±a" />
    <br />
    <button id="loginBtn">Entrar</button>
    <button id="backHomeBtn1">Volver</button>
  </div>

  <!-- ADMIN PANEL -->
  <div id="adminPanel" class="panel hidden">
    <h3>Panel Administrador</h3>

    <!-- Agregar empleado -->
    <div class="card">
      <h4>Agregar empleado</h4>
      <input id="nombreEmpleado" placeholder="Nombre del empleado" />
      <input id="pinEmpleado" placeholder="PIN del empleado" />
      <button id="guardarEmpleadoBtn">Guardar empleado</button>
    </div>

    <!-- Empleados registrados -->
    <div class="card">
      <h4 onclick="toggleSection('listaEmpleados')" style="cursor:pointer;">
        ðŸ‘¥ Empleados registrados â–¼
      </h4>
      <div id="listaEmpleados" style="max-height:300px; overflow:auto;"></div>
    </div>

    <!-- ===== MODAL: EDITAR HORARIO (ADMIN) ===== -->
    <div id="editModalBackdrop" class="modalBackdrop hidden"></div>

    <div id="editModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div class="modalTitle">ðŸ¦· Editar Horario (Administrador)</div>
        <button type="button" id="editCloseBtn" class="modalClose" aria-label="Cerrar">âœ•</button>
      </div>

      <div class="modalBody">
        <label for="editEmpSelect">Empleado</label>
        <select id="editEmpSelect"></select>

        <label for="editFecha">Fecha</label>
        <input type="date" id="editFecha" />

        <label for="editTipo">Tipo de marcaciÃ³n</label>
        <select id="editTipo">
          <option value="entrada">Entrada</option>
          <option value="almuerzo_salida">Salida Almuerzo</option>
          <option value="almuerzo_regreso">Regreso Almuerzo</option>
          <option value="salida">Salida</option>
        </select>

        <label for="editHora">Hora</label>
        <select id="editHora"></select>

        <div id="editStatus" class="notice" style="display:none;"></div>
      </div>

      <div class="modalFooter">
        <button type="button" id="editSaveBtn">ðŸ’¾ Guardar</button>
        <button type="button" id="editCancelBtn" class="danger">Cancelar</button>
      </div>
    </div>
    <!-- ===== FIN MODAL EDITAR HORARIO ===== -->

    <!-- ===== MODAL: ASIGNAR SALARIO (ADMIN) ===== -->
    <div id="salarioModalBackdrop" class="modalBackdrop hidden"></div>

    <div id="salarioModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div class="modalTitle">ðŸ’° Asignar Salario (USD)</div>
        <button type="button" id="salarioCloseBtn" class="modalClose" aria-label="Cerrar">âœ•</button>
      </div>

      <div class="modalBody">
        <label for="salarioEmpNombre">Empleado</label>
        <input id="salarioEmpNombre" type="text" disabled />

        <label for="salarioValor">Salario (USD)</label>
        <input id="salarioValor" type="number" step="0.01" placeholder="Ej: 200 o 200.50" />

        <label for="salarioTipo">Tipo de salario</label>
        <select id="salarioTipo">
          <option value="diario">Diario</option>
          <option value="quincenal">Quincenal</option>
          <option value="mensual">Mensual</option>
        </select>

        <div id="salarioStatus" class="notice" style="display:none;"></div>
      </div>

      <div class="modalFooter">
        <button type="button" id="salarioSaveBtn">ðŸ’¾ Guardar</button>
        <button type="button" id="salarioCancelBtn" class="danger">Cancelar</button>
      </div>
    </div>
    <!-- ===== FIN MODAL SALARIO ===== -->

    <!-- Resumen marcaciones -->
    <div class="card">
      <h4 onclick="toggleSection('adminList')" style="cursor:pointer;">
        Resumen de marcaciones â–¼
      </h4>

      <input type="date" id="filterDate" />

      <label>Desde:</label>
      <input type="date" id="fechaDesde" />

      <label>Hasta:</label>
      <input type="date" id="fechaHasta" />

      <label>Periodo:</label>
      <select id="periodoResumen">
        <option value="diario">Diario</option>
        <option value="quincenal">Quincenal</option>
        <option value="mensual">Mensual</option>
      </select>

      <div id="adminList" style="max-height:300px; overflow:auto;"></div>
    </div>

    <!-- RESUMEN DE PAGOS -->
    <div id="resumenPagos" style="max-height:200px; overflow:auto; margin-top:15px; background:#f0f8ff; padding:10px; border-radius:8px;">
      <h4>ðŸ’° Resumen de pagos y banco de horas</h4>
    </div>

    <!-- Notificaciones -->
    <div class="card">
      <h4 onclick="toggleSection('notificaciones')" style="cursor:pointer;">
        Notificaciones â–¼
      </h4>
      <div id="notificaciones" style="max-height:200px; overflow:auto;"></div>
      <button id="exportMarcBtn">Exportar Marcaciones</button>
      <button id="exportSalarioBtn">Exportar Salario</button>
    </div>

    <!-- GrÃ¡fico -->
    <div class="card">
      <h4>ðŸ“Š GrÃ¡fico de horas trabajadas por empleado</h4>
      <canvas id="horasChart"></canvas>
    </div>

    <button id="logoutBtn">Salir</button>
  </div>

  <!-- EMPLEADO PANEL -->
  <div id="employeePanel" class="card hidden">
    <div class="nombreGrande" id="empNombreGrande"></div>

    <input id="empPin" type="password" placeholder="Ingresa tu PIN" />

    <div id="employeeButtons" class="hidden">
      <button id="entradaBtn">Entrada</button>
      <button id="almuerzoSalidaBtn">Salida Almuerzo</button>
      <button id="almuerzoRegresoBtn">Regreso Almuerzo</button>
      <button id="salidaBtn">Salida</button>
    </div>

    <div id="empMsg" class="notice"></div>
    <button id="backHomeBtn2">Volver</button>
  </div>

</body>
</html>
